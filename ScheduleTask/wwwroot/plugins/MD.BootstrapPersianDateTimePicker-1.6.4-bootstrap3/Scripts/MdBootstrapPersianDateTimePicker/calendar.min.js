function mod(d, c) { return d - (c * Math.floor(d / c)) } function jwday(a) { return mod(Math.floor((a + 1.5)), 7) } var Weekdays = new Array("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"); function leap_gregorian(a) { return ((a % 4) == 0) && (!(((a % 100) == 0) && ((a % 400) != 0))) } var GREGORIAN_EPOCH = 1721425.5; function gregorian_to_jd(b, c, a) { return (GREGORIAN_EPOCH - 1) + (365 * (b - 1)) + Math.floor((b - 1) / 4) + (-Math.floor((b - 1) / 100)) + Math.floor((b - 1) / 400) + Math.floor((((367 * c) - 362) / 12) + ((c <= 2) ? 0 : (leap_gregorian(b) ? -1 : -2)) + a) } function jd_to_gregorian(l) { var h, n, e, b, m, a, o, c, g, i, d, k; h = Math.floor(l - 0.5) + 0.5; n = h - GREGORIAN_EPOCH; e = Math.floor(n / 146097); b = mod(n, 146097); m = Math.floor(b / 36524); a = mod(b, 36524); o = Math.floor(a / 1461); c = mod(a, 1461); g = Math.floor(c / 365); i = (e * 400) + (m * 100) + (o * 4) + g; if (!((m == 4) || (g == 4))) { i++ } d = h - gregorian_to_jd(i, 1, 1); k = ((h < gregorian_to_jd(i, 3, 1)) ? 0 : (leap_gregorian(i) ? 1 : 2)); var f = Math.floor((((d + k) * 12) + 373) / 367); var j = (h - gregorian_to_jd(i, f, 1)) + 1; return new Array(i, f, j) } function leap_persian(a) { return ((((((a - ((a > 0) ? 474 : 473)) % 2820) + 474) + 38) * 682) % 2816) < 682 } var PERSIAN_EPOCH = 1948320.5; var PERSIAN_WEEKDAYS = new Array("دوشنبه", "یکشنبه", "چهارشنبه", "سه شنبه", "شنبه", "جمعه", "پنج شنبه"); function persian_to_jd(b, e, a) { var d, c; d = b - ((b >= 0) ? 474 : 473); c = 474 + mod(d, 2820); return a + ((e <= 7) ? ((e - 1) * 31) : (((e - 1) * 30) + 6)) + Math.floor(((c * 682) - 110) / 2816) + (c - 1) * 365 + Math.floor(d / 2820) * 1029983 + (PERSIAN_EPOCH - 1) } function jd_to_persian(j) { var h, g, i, k, e, a, f, d, c, b; j = Math.floor(j) + 0.5; k = j - persian_to_jd(475, 1, 1); e = Math.floor(k / 1029983); a = mod(k, 1029983); if (a == 1029982) { f = 2820 } else { d = Math.floor(a / 366); c = mod(a, 366); f = Math.floor(((2134 * d) + (2816 * c) + 2815) / 1028522) + d + 1 } h = f + (2820 * e) + 474; if (h <= 0) { h-- } b = (j - persian_to_jd(h, 1, 1)) + 1; g = (b <= 186) ? Math.ceil(b / 31) : Math.ceil((b - 6) / 30); i = (j - persian_to_jd(h, g, 1)) + 1; return new Array(h, g, i) } function calcPersian(d, f, a) { var c, b; b = persian_to_jd(d, f, a); c = jd_to_gregorian(b); var e = jwday(b); return new Array(c[0], c[1], c[2], e) } function calcGregorian(d, f, a) { f--; var c, e; c = gregorian_to_jd(d, f + 1, a) + (Math.floor(0 + 60 * (0 + 60 * 0) + 0.5) / 86400); var b = jd_to_persian(c); e = jwday(c); return new Array(b[0], b[1], b[2], e) } function getTodayGregorian() { var b = new Date(); var a = new Date(); var c = a.getYear(); if (c < 1000) { c += 1900 } return new Array(c, a.getMonth() + 1, a.getDate(), b.getDay()) } function GetTodayCalendarInPersian() { var b = new Date(); var a = getTodayGregorian(); var c = calcGregorian(a[0], a[1], a[2]); return new Array(c[0], c[1], c[2], b.getDay()) };